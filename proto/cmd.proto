syntax = "proto3";

package cmd;

import "spotify.proto";
import "role.proto";
import "room.proto";

message HttpCommand {
  oneof type {
    CreateRoom create_room = 1;
    GetRoom get_room = 2;
    JoinRoom join_room = 3;
  }

  message CreateRoom {
    string user_id = 1;
    string username = 2;
    string name = 3;
    Credentials credentials = 4;
  }

  message GetRoom {
    bytes room_id = 1;
  }

  message Credentials {
    string access_token = 1;
    string refresh_token = 2;
    string expires_in = 3;
    string created_at = 4;
  }

  message JoinRoom {
    bytes room_id = 1;
    string user_id = 2;
    string username = 3;
  }
}

message Command {
  oneof type {
    // Useless bool value
    bool get_room = 1;
    string search = 2;
    AddTrackToQueue add_to_queue = 3;
    uint32 set_volume = 4;
    // Useless bool value
    bool play_resume = 5;
    // Useless bool value
    bool pause = 6;
    // Useless bool value
    bool skip_next = 7;
    // Useless bool value
    bool skip_previous = 8;
    uint64 seek_to_pos = 9;
    Kick kick = 10;
    Ban ban = 11;
    // Useless bool value
    bool leave_room = 12;
    CreateRole create_role = 13;
  }

  message Kick {
    string user_id = 1;
    string reason = 2;
  }

  message Ban {
    string user_id = 1;
    string reason = 2;
  }

  message AddTrackToQueue {
    string track_id = 1;
  }

  message CreateRole {
    string name = 1;
    role.RolePermission permissions = 2;
  }
}

message CommandResponse {
  oneof type {
    room.RoomError room_error = 1;
    room.Room room = 2;
    string generic_error = 3;
    Kick kick = 4;
    Ban ban = 5;
    SpotifyPlaybackState spotify_playback_state = 6;
    spotify.TrackArray spotify_search_result = 7;
    uint64 spotify_rate_limited = 8;
    role.RoleError role_error = 9;
  }

  message Kick {
    string reason = 1;
  }

  message Ban {
    string reason = 1;
  }

  message SpotifyPlaybackState {
    optional spotify.PlaybackState state = 1;
    spotify.TrackArray previous_tracks = 2;
    spotify.TrackArray next_tracks = 3;
  }
}
